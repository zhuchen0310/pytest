{% extends 'base_user_center.html' %}
{% load staticfiles %}
{% block topfiles %}
    <script src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
    <script>
    //加载页面
    $(function () {
        //获取商品数量
        $('.order_goods_list').each(function () {
            var goods_count = $(this).children('.col03').text();
            var goods_count = parseInt(goods_count);
            //获取商品价格
            var goods_price = $(this).find('em').text();
            var goods_price = parseFloat(goods_price );
            // 设置小计

            var total_price = goods_price * goods_count;
            $(this).children('.col04').text(total_price.toFixed(2)+'元');

        })

        $('.order_list_table').each(function () {

        })



    })



    </script>
{% endblock topfiles %}
{% block right_content %}
		<div class="right_content clearfix">
				<h3 class="common_title2">全部订单</h3>
				{% for order_base in order_basic_list %}
				<ul class="order_list_th w978 clearfix">
					<li class="col01">{{ order_base.createtime|date:"Y-m-0j  H:i:s" }}</li>
					<li class="col02">订单号：{{ order_base.order_id }}</li>
                    <li class="col02 stress">已支付</li>
				</ul>
				<table class="order_list_table w980">
					<tbody>
						<tr>
							<td width="55%">
                                {% for order_detail in order_base.order_detail_list %}
								<ul class="order_goods_list clearfix">					
									<li class="col01"><img src="/static/{{ order_detail.img_url }}"></li>
									<li class="col02">{{ order_detail.goods.goods_name }}<em>{{ order_detail.goods.goods_price }}</em>元/{{ order_detail.goods.goods_unite }}</li>
									<li class="col03">{{ order_detail.goods_count }}</li>
									<li class="col04">小计-元</li>
								</ul>
                                    {% endfor %}

							</td>
							<td width="15%">{{ order_base.total_price}}元</td>

                            <td width="15%">已付款</td>

							<td width="15%"><a href="#" class="oper_btn">查看物流</a></td>
						</tr>

    					</tbody>
				</table>
             {% endfor %}

				<div class="pagenation">
					{% if order_basic_list.has_previous %}
				    <a href="/user/order/{{ order_basic_list.number|add:-1 }}/">&lt;上一页</a>
                {% endif %}
                {% for pindex in pages %}
                    {% if pindex == order_basic_list.number  %}
				        <a href="/user/order/{{ pindex }}/" class="active">{{ pindex }}</a>
                    {% else %}
                        <a href="/user/order/{{ pindex }}/">{{ pindex }}</a>
                    {% endif %}
                {% endfor %}
                {% if order_basic_list.has_next %}
				    <a href="/user/order/{{ order_basic_list.number|add:1 }}/">下一页&gt;</a>
                {% endif %}
				</div>
		</div>
{% endblock right_content %}
